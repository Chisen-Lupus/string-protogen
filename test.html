<!DOCTYPE html>
<html lang='en'>

<head>
  
  <meta charset='UTF-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>Protogen Half-Face Expression</title>

  <style>
    /* Set up basic styling */
    body {
      margin: 0;
      background-color: black;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .canvas {
      position: absolute;
      /* testing purpose */
      width: 80vw;
      height: 50vw;
      border: 1px solid gray; /* Dark gray border */
      --test-path: 'M10,10 Q 30,0 50,10 T 90,10 M 90,0 T 80,50 T 80,80 T 80,90 Q 70,60 50,50 T 10,50 Z';
      --path-part1: 'M10,10 Q 30,0 50,10';
      --path-part2: 'T 90,10 L 90,50';
      --path-part3: 'Q 70,60 50,50 T 10,50 Z';
      /* mouth paths */
      /* --mouth-path-closed: 'M10,20 Q 40,40 70,20 T 130,20 T 190,40 T 250,20'; 
      --mouth-path-open: 'M10,20 Q 40,50 70,20 T 130,10 T 190,50 T 250,20';   */
      /* eye mark path */
      /* eye paths */
      /* --upper-lid-path: 'M10,20 Q 50,0 90,20';
      --lower-lid-path: 'M10,35 Q 50,45 90,25';
      --upper-lid-mask-path: 'M10,15 Q 50,-5 90,15'; 
      --lower-lid-mask-path: 'M10,40 Q 50,50 90,30';  */
      /* --pupil-path: 'M50,21 Q48,25 50,29 Q52,25 50,21';  */
    }

    /* Define the eye */
    .eye {
      position: absolute;
      top: 0%;
      left: 40%;
      width: 60%;
      height: 50%;
    }

    /* Black mask for eyelids to create a covering effect */
    .eye .upper-lid-mask, .eye .lower-lid-mask {
      fill: black;
    }
    .eye .upper-lid-mask {
      /* d: path(var(--upper-lid-mask-path)); */
      /* animation: upper-blink 3s infinite; */
      transition: d 0.1s ease-in-out;
    }
    .eye .lower-lid-mask {
      /* d: path(var(--lower-lid-mask-path)); */
      /* animation: lower-blink 3s infinite; */
      /* transform: translateY(20px); Adjust positioning as needed */
      transition: d 0.1s ease-in-out;
    }

    /* Red eyelids */
    .eye .upper-lid, .eye .lower-lid {
      fill: red;
    }
    .eye .upper-lid {
      /* d: path(var(--upper-lid-path)); */
      /* animation: upper-blink 3s infinite; */
      transition: d 0.1s ease-in-out;
    }
    .eye .lower-lid {
      /* d: path(var(--lower-lid-path)); */
      /* animation: lower-blink 3s infinite; */
      transition: d 0.1s ease-in-out;
    }
    
    .eye .eye-svg {
      position: absolute;
      /* z-index: 2; Ensure eyelids (and masks) are above the eyeball */
    }
    
    .eyeball {
      /* z-index: 1; Ensure eyeball is underneath */
      position: absolute;
      fill: pink;

      transition: transform 0.1s ease-in-out;
      /* animation: look-around-eyeball 10s infinite ease-in-out; */
    }
    .pupil {
      fill: black;
      /* d: path(var(--pupil-path)); */

      transition: transform 0.1s ease-in-out;
      /* animation: look-around-pupil 10s infinite ease-in-out; */
    }

    /* Define the eye mark with curved edges */

    .eye-mark {
      position: absolute;
      top: 28%;
      left: 45%;
      width: 50%;
      height: 30%;
      /* animation: pulse 5s infinite; */
    }
    .eye-mark-path {
      fill: red;
      /* d: path(var(--eye-mark-path-1) + var(--eye-mark-path-2)); */
    }

    /* Define the nose */

    .nose {
      position: absolute;
      top: 5%;
      left: 5%;
      width: 15%;
      height: 25%;
      background-color: red;
      /* border-radius: 50%; */
      /* clip-path: polygon(20% 100%, 0 20%, 100% 0, 30% 35%); */
      /* transform: rotate(45deg); */
    }
    .nose-path {
      fill: red;
    }

    /* Define the mouth using SVG */
    .mouth {
      position: absolute;
      bottom: 00%;
      left: 0%;
      width: 100%;
      height: 60%;
    }
    .mouth-path {
      fill: none;
      stroke: red;
      stroke-width: 2;
      stroke-linecap: round;
      /* animation: smile 10s infinite; */
      transition: d 0.1s ease-in-out;
    }

    /* for testing purpose */

    .test {
      position: absolute;
      bottom: 0%;
      left: 0%;
      width: 100%;
      height: 100%;
    }
    .test path {
      fill: red;
      /* d: path(var(--test-path)); */
      /* d: path(var(--path-part1) var(--path-part2) var(--path-part3)); */
    }
    .hidden {
      display: none;
    }
    .showbox {
      background-color: rgba(255, 255, 255, 0.1); 
    }

    /* Animations */
    @keyframes upper-blink {
      0%, 87% {
        transform: translateY(0); /* Default position */
      }
      92%, 95% {
        transform: translateY(15px); /* Move down to cover part of the eyeball */
      }
      100% {
        transform: translateY(0); /* Move back up */
      }
    }

    @keyframes lower-blink {
      0%, 87% {
        transform: translateY(0); /* Default position */
      }
      92%, 95% {
        transform: translateY(-5px); /* Move up to cover part of the eyeball */
      }
      100% {
        transform: translateY(0); /* Move back down */
      }
    }
    /* @keyframes smile {
      0%, 50%, 100% {
        d: path(var(--mouth-path-closed));
      }
      25%, 75% {
        d: path(var(--mouth-path-open));
      }
    }
    @keyframes pulse {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.05);
      }
    } */

    @keyframes look-around-eyeball {
      0%, 20% {
        transform: translateX(0); /* Centered */
      }
      25%, 35% {
        transform: translateX(-3px); /* Slightly left */
      }
      40%, 60% {
        transform: translateX(0); /* Centered */
      }
      65%, 75% {
        transform: translateX(3px); /* Slightly right */
      }
      80%, 100% {
        transform: translateX(0); /* Centered */
      }
    }

    /* Animation for the pupil */
    @keyframes look-around-pupil {
      0%, 20% {
        transform: translateX(0); /* Centered */
      }
      25%, 35% {
        transform: translateX(-5px); /* Further left than the eyeball */
      }
      40%, 60% {
        transform: translateX(0); /* Centered */
      }
      65%, 75% {
        transform: translateX(5px); /* Further right than the eyeball */
      }
      80%, 100% {
        transform: translateX(0); /* Centered */
      }
    }


  </style>

</head>

<body>

  <div class='canvas'>

    <!-- Eye -->
    <div class='eye showbox'>
      <svg viewBox='0 0 100 50' class='eye-svg'>
        <!-- <circle class='eyeball' cx='50' cy='25' r='10' /> -->
        <circle class='eyeball' />
        <path class='pupil' />
        <path class='upper-lid-mask' />
        <path class='lower-lid-mask' />
        <path class='upper-lid' />
        <path class='lower-lid' />
      </svg>
    </div>

    <!-- Nose -->
    <div class='nose showbox'>
      <svg viewBox='0 0 100 100'>
        <path class='nose-path' />
      </svg>
    </div>

    <!-- Eye mark -->
    <div class='eye-mark showbox'>
      <svg viewBox='0 0 100 100'>
        <path class='eye-mark-path' />
      </svg>
    </div>

    <!-- Mouth  -->
    <div class='mouth showbox'>
      <svg viewBox='0 0 100 100'>
        <path class='mouth-path' />
      </svg>
    </div>

    <!-- test -->
    <svg class='test' viewBox='0 0 100 100'>
      <path />
    </svg>

  </div>

  <script>

    // utility functions

    Element.prototype.setAttributes = function(attributes) {
      for (const key in attributes) {
        this.setAttribute(key, attributes[key]);
      }
    };

    // eye mark

    const eyeMarkPath = `
      M 5,90 T 20,80 T 60,42 T 90,12 T 95,10
      L 95,10 T 85,23 T 65,51 T 55,65
      L 55,65 T 70,56 T 85,47 T 92,45
      L 92,45 T 80,58 T 60,80 T 40,92 T 15,93 T 5,90
    `;
    const eyeMark = document.querySelector('.eye-mark-path')
    eyeMark.setAttribute('d', eyeMarkPath.trim());

    // mouth

    const mouthPathClosed = 'M10,20 Q 40,40 70,20 T 130,20 T 190,40 T 250,20';
    const mouthPathOpen = 'M10,20 Q 40,50 70,20 T 130,10 T 190,50 T 250,20';
    const mouthPath = document.querySelector('.mouth-path');
    mouthPath.setAttribute('d', mouthPathClosed);

    function toggleMouth() {
      const currentPath = mouthPath.getAttribute('d');
      if (currentPath===mouthPathClosed) {
        mouthPath.setAttribute('d', mouthPathOpen);
      } else {
        mouthPath.setAttribute('d', mouthPathClosed);
      }
    }

    setInterval(toggleMouth, 1000);

    // eyelid

    // opened svg paths
    const upperLidPathOpen = 'M10,20 Q 50,0 90,20';
    const lowerLidPathOpen = 'M10,35 Q 50,45 90,25';
    const upperMaskPathOpen = 'M10,15 Q 50,-5 90,15';
    const lowerMaskPathOpen = 'M10,40 Q 50,50 90,30';
    // closed svg states
    const upperLidPathClose = 'M10,30 Q 50,10 90,30';
    const lowerLidPathClose = 'M10,25 Q 50,35 90,15';
    const upperMaskPathClose = 'M10,25 Q 50,5 90,25';
    const lowerMaskPathClose = 'M10,30 Q 50,40 90,20';
    // get css variable
    const upperLidPath = document.querySelector('.upper-lid');
    const lowerLidPath = document.querySelector('.lower-lid');
    const upperMaskPath = document.querySelector('.upper-lid-mask');
    const lowerMaskPath = document.querySelector('.lower-lid-mask');
    // Initialize to open state
    upperLidPath.setAttribute('d', upperLidPathOpen);
    lowerLidPath.setAttribute('d', lowerLidPathOpen);
    upperMaskPath.setAttribute('d', upperMaskPathOpen);
    lowerMaskPath.setAttribute('d', lowerMaskPathOpen);

    function blinkEye() {
      // Close eye first
      upperLidPath.setAttribute('d', upperLidPathClose);
      lowerLidPath.setAttribute('d', lowerLidPathClose);
      upperMaskPath.setAttribute('d', upperMaskPathClose);
      lowerMaskPath.setAttribute('d', lowerMaskPathClose);
      // Reopen eye after a delay
      setTimeout(() => {
        upperLidPath.setAttribute('d', upperLidPathOpen);
        lowerLidPath.setAttribute('d', lowerLidPathOpen);
        upperMaskPath.setAttribute('d', upperMaskPathOpen);
        lowerMaskPath.setAttribute('d', lowerMaskPathOpen);
      }, 200); // Delay before reopening
    }

    // Blink every 1 second (adjust as needed)
    setInterval(blinkEye, 5000);

    // pupil

    const eyeball = document.querySelector('.eyeball');
    const pupil = document.querySelector('.pupil');
    const eyeballAttributes = {cx: 50, cy: 25, r: 10};
    const pupilPath = 'M50,21 Q48,25 50,29 Q52,25 50,21'; 
    eyeball.setAttributes(eyeballAttributes);
    pupil.setAttribute('d', pupilPath);

    const eyeballPositions = [0, -3, 0, 3, 0];  
    const pupilPositions = [0, -5, 0, 5, 0];  

    function animateLookAround() {
      eyeball.style.transform = `translateX(${eyeballPositions[0]}px)`;
      pupil.style.transform = `translateX(${pupilPositions[0]}px)`;
      setTimeout(() => {
        eyeball.style.transform = `translateX(${eyeballPositions[1]}px)`;
        pupil.style.transform = `translateX(${pupilPositions[1]}px)`;
      }, 500); // Delay of 500ms
      setTimeout(() => {
        eyeball.style.transform = `translateX(${eyeballPositions[2]}px)`;
        pupil.style.transform = `translateX(${pupilPositions[2]}px)`;
      }, 1000); // Delay of 1000ms
      setTimeout(() => {
        eyeball.style.transform = `translateX(${eyeballPositions[3]}px)`;
        pupil.style.transform = `translateX(${pupilPositions[3]}px)`;
      }, 1500); // Delay of 1500ms
      setTimeout(() => {
        eyeball.style.transform = `translateX(${eyeballPositions[4]}px)`;
        pupil.style.transform = `translateX(${pupilPositions[4]}px)`;
      }, 2000); // Delay of 2000ms
    }

    setInterval(animateLookAround, 2500); // Repeat every 2.5 seconds

    // nose
    
    const nosePath = 'M 20,100 L 0,20 L 100,0 L 30,35 Z';
    const nose = document.querySelector('.nose-path')
    nose.setAttribute('d', nosePath);

  </script>

</body>

</html>
